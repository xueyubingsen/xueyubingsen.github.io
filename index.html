<!DOCTYPE html>
<html>
  <head>
    <title>TiDB Parameters Summary</title>
  </head>
  <body>
    <!-- 1. Prepare container -->
    <div id="container" style="width: 800px; height: 400px"></div>

    <!-- 2. Add Script tag that specific G6 umd url -->
    <script src="https://unpkg.com/@antv/g6@5/dist/g6.min.js"></script>

    <script>
      // 3. Prepare data

// Calculate degrees for each node
// 生成50个节点
const nodes = Array.from({ length: 50 }, (_, i) => ({ id: `node-${i}` }));

// 随机生成边连接
const edges = [];
for (let i = 0; i < 50; i++) {
  const sourceId = `node-${i}`;
  // 每个节点随机连接1-5个其他节点
  const connectionCount = Math.floor(Math.random() * 5) + 1;
  for (let j = 0; j < connectionCount; j++) {
    const targetIndex = Math.floor(Math.random() * 50);
    const targetId = `node-${targetIndex}`;
    // 避免自连接和重复连接
    if (sourceId !== targetId && !edges.some(edge => 
        (edge.source === sourceId && edge.target === targetId) || 
        (edge.source === targetId && edge.target === sourceId))) {
      edges.push({ source: sourceId, target: targetId });
    }
  }
}

// 计算每个节点的度数（连接数）
const degrees = {};
nodes.forEach(node => {
  degrees[node.id] = 0;
});

edges.forEach(edge => {
  degrees[edge.source]++;
  degrees[edge.target]++;
});

// 创建图数据
const data = { nodes, edges };

// 创建G6图实例
const graph = new Graph({
  container: 'container',
  width: 1200,
  height: 800,
  autoFit: 'view',
  data: data,
  node: {
    style: {
      size: (d) => Math.max(20, degrees[d.id] * 5 + 10), // 根据连接数确定节点大小
      fill: '#1890FF',
      stroke: '#0077CC',
      lineWidth: 1,
      label: (d) => degrees[d.id].toString(), // 显示连接数
      labelFill: '#fff',
      labelFontSize: 12,
    },
  },
  edge: {
    style: {
      stroke: '#91D5FF',
      lineWidth: 1,
      endArrow: true,
    },
  },
  layout: {
    type: 'd3-force',
    preventOverlap: true,
    nodeSize: (d) => Math.max(20, degrees[d.id] * 5 + 10),
    link: {
      distance: 100,
      strength: 0.5,
    },
    collide: {
      radius: (d) => Math.max(20, degrees[d.id] * 5 + 10) / 2 + 5,
      strength: 0.8,
    },
    manyBody: {
      strength: -200,
    },
  },
  behaviors: [
    'drag-canvas',
    'zoom-canvas',
    {
      type: 'drag-element-force',
      fixOnDragEnd: true,
    },
  ],
});

graph.render();
    </script>
  </body>
</html>
